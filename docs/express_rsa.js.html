<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: express/rsa.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: express/rsa.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
*@module rsa
*/

var p = 0;
var q = 0;
var n = 0;
var phin = 0;
var e = 0;
var d = 0;

function RSA(firstPrime, secondPrime){
  p = firstPrime;
  q = secondPrime;
  n = p * q;
  phin = phiN(p, q);
  e = calculateE(p, q);  //an integer, not a factor of n, 1 &lt; e &lt; sigma(n)
  d = calculateD(p, q);
  console.log("d is: " + d);
  console.log("n is: " + n);
  console.log("phin is: " + phin);
  console.log("e is: " + e);
  console.log("Done");
}
function greatestCommonDivisor(numberA, numberB){
  var a = numberA;
  var h = numberB;
  var temporary;
  while(true){
    temporary = a % h;
    if(temporary == 0){
      return h;
    }
    a = h;
    h = temporary;
  }
}

function phiN(p, q){
  //Total number of numbers that are not factors of n.
  return ((p-1) * (q-1));
}

function calculateE(p, q){
  var eTemp = 2;
  while(eTemp &lt; phin){
    if(greatestCommonDivisor(eTemp, phin) == 1){
      break;
    }
    else{
      eTemp++;
    }
  }
  return eTemp;
}

function calculateD(p, q){
  var k = 2;
  return ((k * phin) + 1)/ e;
}

function encrypt(message){
  var unicodeArray = textToUnicode(message);
  var encryptedArray = [];
  for (var i = 0; i &lt; unicodeArray.length; i ++){
    encryptedArray.push(Math.pow(unicodeArray[i], e) % n);
    console.log((Math.pow(unicodeArray[i], e)) % n);
  }
  console.log(encryptedArray);

  return encryptedArray;
  //return pow(message, e) % n;
}

function decrypt(message){
  var unicodeArray = message;
  console.log(unicodeArray);
  var decryptedArray = [];
  for (var i = 0; i &lt; unicodeArray.length; i ++){
    decryptedArray.push(Math.pow(unicodeArray[i], d) % n);

    console.log(Math.pow(unicodeArray[i], d));
  }
  console.log(decryptedArray);
  return unicodeToText(decryptedArray);
  //return Math.pow(message, d) % n;
}

function textToUnicode(message){
  var unicodeArray = [];
  for(var i = 0; i &lt; message.length; i++){
    unicodeArray.push(message.charCodeAt(i));
  }
  return unicodeArray;
}

function unicodeToText(unicodeArray){
  var messageArray = [];
  for(var i = 0; i &lt; unicodeArray.length; i++){
    messageArray.push(String.fromCharCode(unicodeArray[i]));
  }
  return messageArray.join("");
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-index.html">index</a></li><li><a href="module-rsa.html">rsa</a></li><li><a href="module-server.html">server</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Feb 04 2021 07:58:06 GMT+0100 (centraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
